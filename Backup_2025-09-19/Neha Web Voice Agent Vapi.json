{
  "createdAt": "2025-09-19T03:17:41.685Z",
  "updatedAt": "2025-09-19T03:18:15.000Z",
  "id": "gCl5o9oF557rPw1b",
  "name": "Neha Web Voice Agent Vapi",
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "a7b9d202-f444-4a68-be66-1162acd4e521",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        0,
        0
      ],
      "id": "e6c890bf-1d6d-45a2-aed2-d3dd166b9efe",
      "name": "webhook_trigger",
      "webhookId": "a7b9d202-f444-4a68-be66-1162acd4e521"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.toolThink",
      "typeVersion": 1,
      "position": [
        336,
        288
      ],
      "id": "0df642ea-e80f-44c9-a01b-6a771546546f",
      "name": "think"
    },
    {
      "parameters": {
        "calendar": {
          "__rl": true,
          "value": "sinisyssoft@gmail.com",
          "mode": "list",
          "cachedResultName": "sinisyssoft@gmail.com"
        },
        "start": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', `Start time for the dental appointment. You should assume this is a Indian timezone timestamp (IST).`, 'string') }}",
        "end": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', `End time for the dental appointment. This should be 1 hour AFTER the start time. This will be in the Indian Time Zone (IST).`, 'string') }}",
        "additionalFields": {
          "attendees": [
            "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('attendees0_Attendees', ``, 'string') }}"
          ],
          "summary": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Summary', 'The title/summary of this event should be in the format of \"Dental Appointment | {patient_name}\" where `patient_name` is the provided name of the patient.', 'string') }}"
        }
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        656,
        288
      ],
      "id": "b6d6b7db-05b6-4a04-9ca8-c31a70888a4d",
      "name": "create_appointment"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "{\n    \"results\": [\n        {\n            \"toolCallId\": \"X\",\n            \"result\": \"Y\"\n        }\n    ]\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        816,
        0
      ],
      "id": "9d80be82-b49d-4718-9d44-22e5c8da3985",
      "name": "respond_to_webhook"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        0,
        288
      ],
      "id": "e532e5ad-859a-47c2-a92f-bfc820f87859",
      "name": "gemini-2.5-flash"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=## Request Data\n\n{{ JSON.stringify($json.body, null, 2)}}\n",
        "options": {
          "systemMessage": "=You are the Angel Clinic appointment agent.\n\nSteps:\nUse get_availability (08:00 AM–05:00 PM IST, skip 12–01 PM). Check multiple times until 2 slots found or none.\n\nSuggest slots to patient in Day-Month-Year, 12-hour IST with AM/PM.\n\nWhen patient chooses, call create_appointment (1-hour, only once).\n\nConfirm booking.\n\nCall log_patient_details once at the end (only if all info complete).\n\nRules:\n\nUse think before any tool call.\n\nTool input/output must be ISO timestamps in IST.\n\nNever call create_appointment or log_patient_details more than once."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        304,
        0
      ],
      "id": "41ad65b3-a105-4345-abbf-14be586b45e6",
      "name": "dental_agent"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1G3gYYIrKPD4oxffeqmw-lQffUmncMsJxoDTGbKVXaXo",
          "mode": "list",
          "cachedResultName": "Log Patient Details",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1G3gYYIrKPD4oxffeqmw-lQffUmncMsJxoDTGbKVXaXo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1G3gYYIrKPD4oxffeqmw-lQffUmncMsJxoDTGbKVXaXo/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Call Timestamp": "={{ $now.toString() }}",
            "Patient Name": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Patient_Name', `Name of the patient booking their appointment.`, 'string') }}",
            "Questions & Concerns": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Questions___Concerns', `Optional questions or concerns raised by the patient booking the appointment.`, 'string') }}",
            "Appointment Timestamp": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Appointment_Timestamp', `Timestamp the appointment is booked for.`, 'string') }}",
            "Email Id": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Email_Id', ``, 'string') }}",
            "phone number": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('phone_number', ``, 'string') }}"
          },
          "matchingColumns": [
            "Patient Name"
          ],
          "schema": [
            {
              "id": "Patient Name",
              "displayName": "Patient Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Email Id",
              "displayName": "Email Id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "phone number",
              "displayName": "phone number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Call Timestamp",
              "displayName": "Call Timestamp",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Questions & Concerns",
              "displayName": "Questions & Concerns",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Appointment Timestamp",
              "displayName": "Appointment Timestamp",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.6,
      "position": [
        816,
        288
      ],
      "id": "5f9474f1-20be-4f82-9487-50c4b8916e44",
      "name": "log_patient_details"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "sessionID",
        "contextWindowLength": 10
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        176,
        288
      ],
      "id": "20bda1e7-e016-4216-aa74-f96e8899b749",
      "name": "simple-memory"
    },
    {
      "parameters": {
        "resource": "calendar",
        "calendar": {
          "__rl": true,
          "value": "sinisyssoft@gmail.com",
          "mode": "list",
          "cachedResultName": "sinisyssoft@gmail.com"
        },
        "timeMin": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start_Time', `The start timestamp for the dental appointment.`, 'string') }}",
        "timeMax": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End_Time', `The end time will always be the Start Time plus 1 hour.`, 'string') }}",
        "options": {
          "timezone": {
            "__rl": true,
            "value": "Asia/Calcutta",
            "mode": "list",
            "cachedResultName": "Asia/Calcutta"
          }
        }
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        496,
        288
      ],
      "id": "f72b8074-0cbc-421a-b7c3-2789f219309d",
      "name": "get_availability"
    }
  ],
  "connections": {
    "webhook_trigger": {
      "main": [
        [
          {
            "node": "dental_agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "think": {
      "ai_tool": [
        [
          {
            "node": "dental_agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "create_appointment": {
      "ai_tool": [
        [
          {
            "node": "dental_agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "gemini-2.5-flash": {
      "ai_languageModel": [
        [
          {
            "node": "dental_agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "dental_agent": {
      "main": [
        [
          {
            "node": "respond_to_webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "log_patient_details": {
      "ai_tool": [
        [
          {
            "node": "dental_agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "simple-memory": {
      "ai_memory": [
        [
          {
            "node": "dental_agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "get_availability": {
      "ai_tool": [
        [
          {
            "node": "dental_agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": null,
  "pinData": {},
  "versionId": "6456b5f1-adc5-4ee9-97de-37335ac6da14",
  "triggerCount": 0,
  "shared": [
    {
      "createdAt": "2025-09-19T03:17:41.689Z",
      "updatedAt": "2025-09-19T03:17:41.689Z",
      "role": "workflow:owner",
      "workflowId": "gCl5o9oF557rPw1b",
      "projectId": "nnULjHyqOVknXpmc"
    }
  ],
  "tags": []
}