{
  "createdAt": "2025-10-03T13:19:15.833Z",
  "updatedAt": "2025-10-03T13:41:14.000Z",
  "id": "yLZqcYCIteTJe3K0",
  "name": "My workflow 20",
  "active": false,
  "isArchived": true,
  "nodes": [
    {
      "parameters": {
        "method": "POST",
        "url": "https://google.serper.dev/search",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "q",
              "value": "={{ $json[\"Main Keywords\"] }}, {{ $json[\"Other Keywords\"] }}"
            }
          ]
        },
        "options": {
          "redirect": {
            "redirect": {
              "followRedirects": true,
              "maxRedirects": 21
            }
          },
          "response": {}
        }
      },
      "id": "995641b3-7b69-45d4-98a0-fce60aef8bbf",
      "name": "SERP Research",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -272,
        96
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "odw0FaTRUSGiHCOl",
          "name": "Serper dev Header Auth account"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {
              "content": "Je bent een expert SEO content analist gespecialiseerd in Nederlandse contentstrategieën. Je analyseert SERP-data en nieuwsresultaten om strategische inzichten te genereren die voldoen aan strikte Nederlandse SEO-richtlijnen en conversie-geoptimaliseerde content.",
              "role": "model"
            },
            {
              "content": "=Analyseer deze onderzoeksdata voor het keyword \"{{ $json.Keyword }}\", en subtrefwoord \"{{ $json.other_keywords }}\".\n\nSERP Data: \nNews Data: \nGeef een gestructureerde samenvatting met:\n1. Belangrijkste trends en inzichten\n2. Relevante statistieken en feiten\n3. Recente ontwikkelingen\n4. Aanbevelingen voor inhoud focus"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        288,
        176
      ],
      "id": "66e27e24-d932-4c55-b17d-a8b79272f957",
      "name": "Analyze Research Data",
      "credentials": {
        "googlePalmApi": {
          "id": "13GUWdzP5u5goYYi",
          "name": "Google Gemini(PaLM) Api account - Ansh"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {
              "content": "Je bent een expert Nederlandse SEO content writer gespecialiseerd in conversie-geoptimaliseerde artikelen die voldoen aan strikte SEO-richtlijnen. Je schrijft boeiende, goed gestructureerde content die zowel zoekmachines als lezers aanspreekt en eindigt met effectieve call-to-actions.",
              "role": "model"
            },
            {
              "content": "==Schrijf een volledig SEO-geoptimaliseerd artikel in het Nederlands voor het keyword \"{{ $('Preserve Context').item.json.Keyword }}\", en subtrefwoord \"{{ $('Preserve Context').item.json.other_keywords }}\".\n\nSTRUCTUUR & VEREISTEN:\n1. Voeg een duidelijke **Text Heading** bovenaan toe.\n2. **Meta Title**:\n   - Lengte: 60–65 karakters (inclusief spaties).\n   - Bevat het hoofdkeyword (bij voorkeur aan het begin).\n   - Eindigt met vraagteken, uitroepteken of “- bedrijfsnaam”.\n   - Scanbaar, uniek en relevant voor de inhoud.\n3. **Meta Description**:\n   - Lengte: 155–160 karakters.\n   - Actieve schrijfstijl.\n   - Bevat hoofdkeyword + synoniemen.\n   - Start met een vraag + kort antwoord of een emotionele trigger.\n   - Eindig altijd met een USP of duidelijke CTA.\n   - Uniek en scanbaar.\n4. Benoem de **focus keywords** en subkeywords waarop geoptimaliseerd wordt.\n5. **Artikelstructuur**:\n   - **H1**: hoofdkeyword (slechts één keer, aan het begin van de tekst).\n   - **Introductie**: Trigger de lezer, beschrijf kort het probleem en wat men leert. Eindig met een CTA.\n   - **H2 (eerste H2)**: bevat ook het hoofdkeyword.\n   - Gebruik H2’s en H3’s hiërarchisch, zoals in een boek.\n   - **Paragrafen** max. 7 regels lang.\n   - **Commercial Activation Section**: \n     - Titel (H2 of H3).\n     - 2 regels korte tekst.\n     - Bulletlijst met ✅ en vetgedrukte woorden + uitleg.\n   - **Closing CTA**: eindig het artikel altijd met een sterke CTA.\n6. **SEO Richtlijnen**:\n   - Focus keyword-dichtheid 2%–5%.\n   - Gebruik synoniemen en gerelateerde zoekwoorden natuurlijk.\n   - Voeg interne links toe naar andere relevante pagina’s (gebruik placeholders zoals [Interne link]).\n   - Vermijd externe links.\n   - Zorg voor scanbare zinnen en aantrekkelijke opmaak.\n7. Schrijfstijl:\n   - Professioneel, boeiend en waardevol.\n   - Gemakkelijk leesbaar en actief.\n   - Woordenaantal: 1500 - 1800 \n8. Gebruik de tool 'Artikelbron' voor schrijfstijl, structuur en toon met deze invoer:{{ $json.content.parts[0].text }}\nHET ARTIKEL MOET DIT RETOURNEREN IN VOLGORDE:\n1. Meta Title\n2. Meta Description\n3. Lijst met focus keywords\n4. Volledig artikel met alle bovenstaande structuurregels toegepast"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        816,
        160
      ],
      "id": "eda5822e-f24c-47dd-ade7-06b6f0574d6b",
      "name": "Write SEO Article1",
      "credentials": {
        "googlePalmApi": {
          "id": "AddN13YCTv8VpGh7",
          "name": "Google Gemini(PaLM) Api account -cognigenai"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {
              "content": "Je bent een strenge Nederlandse SEO content quality assessor die artikelen beoordeelt op naleving van SEO-richtlijnen, leesbaarheid en conversie-optimalisatie. Je levert ALLEEN een JSON-object als output, zonder extra tekst.",
              "role": "model"
            },
            {
              "content": "=Beoordeel dit Nederlandse artikel en lever een JSON-beoordeling:\n\n{{ $json.content.parts[0].text }}\n\nBEOORDEEL OP (score 1-10 per categorie):\n\nSEO (seo_score): Meta title 60-65 chars met keyword, meta description 155-160 chars met CTA, ÉÉN H1 met keyword, eerste H2 met keyword, keyword in eerste paragraaf, hiërarchische headings, keyword density 2-5%, interne links, GEEN externe links\n\nLEESBAARHEID (readability_score): Alinea's max 7 regels, korte zinnen, actieve vorm, logische flow, correcte spelling\n\nCONTENT (content_quality): Pakkende intro met probleem, actuele feiten/statistieken, toegevoegde waarde, beantwoordt zoekintentie, expertise zichtbaar\n\nPRAKTIJK (practical_value): Actionable tips, concrete voorbeelden, lost probleem op, relevant voor doelgroep\n\nSTRUCTUUR (general_structure): Metadata bovenaan, één H1, gebalanceerde H2/H3 verdeling, commerciële activatie sectie (titel + max 2 regels + bullets met vetgedrukt woord), afsluitende CTA\n\nCONVERSIE (commercial_effectiveness): Effectieve USP communicatie, concrete CTAs, vertrouwenselementen, actieve taal, balans informeren/converteren\n\nKRITIEKE FOUTEN (score ≤4): Meerdere H1s, geen keyword eerste paragraaf, ontbrekende metadata, alinea's >10 regels, geen CTA, keyword spamming >5%, externe links\n\nOUTPUT (exact formaat):\n{\n  \"overall_score\": [1-10],\n  \"seo_score\": [1-10],\n  \"readability_score\": [1-10],\n  \"content_quality\": [1-10],\n  \"practical_value\": [1-10],\n  \"general_structure\": [1-10],\n  \"commercial_effectiveness\": [1-10],\n  \"feedback\": {\n    \"strengths\": [\"Punt 1\", \"Punt 2\", \"Punt 3\"],\n    \"critical_issues\": [\"Issue 1\", \"Issue 2\", \"Issue 3\"],\n    \"improvements_needed\": [\"Verbetering 1\", \"Verbetering 2\", \"Verbetering 3\"],\n    \"seo_specific\": [\"SEO punt 1\", \"SEO punt 2\"],\n    \"conversion_notes\": [\"CTA punt 1\", \"CTA punt 2\"]\n  },\n  \"quality_gate_passed\": [true als ≥7, anders false],\n  \"revision_priority\": \"HIGH/MEDIUM/LOW\"\n}\n\nSCORES: 9-10=Excellent, 7-8=Good, 5-6=Adequate, 3-4=Poor, 1-2=Very Poor\n\nWees streng, specifiek en actionable. LEVER ALLEEN JSON."
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        1104,
        160
      ],
      "id": "cecd594b-e9fc-4d6a-ab05-0b88bf068cb1",
      "name": "Content Quality Check"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {
              "content": "Je bent een expert Nederlandse content editor die artikelen verbetert op basis van kwaliteitsfeedback. Je herschrijft content om hogere SEO-scores, betere leesbaarheid en sterkere conversie te behalen, terwijl je alle client richtlijnen respecteert.",
              "role": "model"
            },
            {
              "content": "=Verbeter dit Nederlandse artikel op basis van de kwaliteitsfeedback:\n\nORIGINEEL ARTIKEL:\n{{ $('Write SEO Article1').item.json.content.parts[0].text }}\n\nKWALITEITSFEEDBACK:\n{{ $('Content Quality Check').item.json.content.parts[0].text }}\n\nFOCUS keyword \"{{ $('Preserve Context').item.json.Keyword }}\", en subtrefwoord \"{{ $('Preserve Context').item.json.other_keywords }}\".\n\n═══════════════════════════════════════════════════════════════\nREVISIE OPDRACHT\n═══════════════════════════════════════════════════════════════\n\nCreëer een verbeterde versie die:\n\n✅ KRITIEKE ISSUES OPLOST:\n- Los alle \"critical_issues\" uit de feedback op\n- Corrigeer SEO fouten (metadata, H1, keyword placement, heading hiërarchie)\n- Fix structurele problemen (alinea lengte, CTA's, commerciële activatie)\n\n✅ SEO VERBETERINGEN:\n- Meta title: 60-65 chars, keyword aan begin, eindigt correct\n- Meta description: 155-160 chars, actieve vorm, keyword + CTA\n- ÉÉN H1 met hoofdkeyword (bij voorkeur aan begin)\n- Eerste H2 bevat hoofdkeyword\n- Keyword in eerste paragraaf\n- Hiërarchische headings (geen sprongen)\n- Keyword density 2-5% (geen spamming)\n- Keyword variaties in andere headings\n- Interne links waar relevant, GEEN externe links\n\n✅ LEESBAARHEID:\n- Max 7 regels per alinea\n- Kortere, krachtigere zinnen\n- Actieve schrijfvorm\n- Betere flow en scanbaarheid\n- Meer witruimte\n\n✅ CONTENT KWALITEIT:\n- Pakkendere introductie die probleem + oplossing beschrijft\n- Meer concrete feiten en actuele statistieken\n- Diepere expertise en toegevoegde waarde\n- Beantwoord zoekintentie completer\n- Unieke invalshoek sterker naar voren\n\n✅ COMMERCIËLE ACTIVATIE:\nZorg voor correcte structuur:\n**H2 - [Pakkende commerciële titel]**\n[Max 2 regels intro]\n\n✓ **[Voordeel 1 vetgedrukt]:** Uitleg\n✓ **[Voordeel 2 vetgedrukt]:** Uitleg\n✓ **[Voordeel 3 vetgedrukt]:** Uitleg\n✓ **[Voordeel 4 vetgedrukt]:** Uitleg\n\n✅ AFSLUITENDE CTA:\n- Krachtige call-to-action\n- Actieve taal\n- Concrete volgende stap\n- Urgentie of waarde duidelijk\n\n═══════════════════════════════════════════════════════════════\nBELANGRIJKE REGELS\n═══════════════════════════════════════════════════════════════\n\nBEHOUD:\n- De kernboodschap en hoofdstructuur (als die goed is)\n- Goede content die wel werkt\n- Het focus keyword \"{{ $('Preserve Context').item.json.Keyword }}\", en subtrefwoord \"{{ $('Preserve Context').item.json.other_keywords }}\".\n\nVERBETER/HERSCHRIJF:\n- Alles wat in feedback als \"critical_issues\" of \"improvements_needed\" staat\n- Zwakke secties die niet voldoen aan richtlijnen\n- Metadata als die niet optimaal is\n- CTA's die niet overtuigend genoeg zijn\n\nOUTPUT FORMAAT:\nLever het volledige, herziene artikel inclusief:\n1. Metadata (meta title, meta description, keywords)\n2. Volledig artikel (H1 t/m afsluitende CTA)\n3. Geen extra commentaar\n\nSCHRIJF NU DE VERBETERDE VERSIE DIE EEN SCORE ≥7 ZAL BEHALEN."
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        1808,
        304
      ],
      "id": "55827082-16cd-487d-880b-36b3b6c4cafb",
      "name": "Revise Article"
    },
    {
      "parameters": {
        "jsCode": "// Extract first line from document_content\nconst content = $json.document_content || '';\nconst title = content.split('\\n')[0].replace(/^#+\\s*/, '');\n\n// Return it as a field so next nodes can access it\nreturn [\n  {\n    json: {\n      ...$json,\n      title_from_content: title\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2544,
        160
      ],
      "id": "6d9f27fe-272a-4529-a04d-e29e116bebf8",
      "name": "TITLE EXTRACTOR"
    },
    {
      "parameters": {
        "method": "POST",
        "url": " https://md2doc.n8n.aemalsayer.com",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googleDriveOAuth2Api",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "fileName",
              "value": "={{ $json.title_from_content }}_{{ $json.Keyword }}\n"
            },
            {
              "name": "output",
              "value": "={{$json.document_content}}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2720,
        160
      ],
      "id": "aa10038d-966f-4a6e-a6c7-674586f66573",
      "name": "DOC CREATOR"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "id": "quality-threshold",
              "leftValue": "={{ $json.overall_score }}",
              "rightValue": 7,
              "operator": {
                "type": "number",
                "operation": "gte"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "id": "d2fd6193-3e1f-4481-b09f-2e95917b7b9b",
      "name": "Quality CHECK",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        1616,
        144
      ]
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1EyqhQ9WEeuq0shMHDUZdpWMx32Ns7ioLkSqT2ecYf60",
          "mode": "list",
          "cachedResultName": "Keyword  Content Generator",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1EyqhQ9WEeuq0shMHDUZdpWMx32Ns7ioLkSqT2ecYf60/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 2141568874,
          "mode": "list",
          "cachedResultName": "Error",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1EyqhQ9WEeuq0shMHDUZdpWMx32Ns7ioLkSqT2ecYf60/edit#gid=2141568874"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "keyword": "={{ $json[\"Main Keywords\"] }}",
            "Error Message ": "={{ $json.error.message }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "keyword",
              "displayName": "keyword",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Error Message ",
              "displayName": "Error Message ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        0,
        0
      ],
      "id": "c1eeeddf-52bd-4f28-ad86-189b525247ab",
      "name": "FLAG ERROR1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ZG1MR4HwHasbUvb4",
          "name": "Cognigenai Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1EyqhQ9WEeuq0shMHDUZdpWMx32Ns7ioLkSqT2ecYf60",
          "mode": "list",
          "cachedResultName": "Keyword  Content Generator",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1EyqhQ9WEeuq0shMHDUZdpWMx32Ns7ioLkSqT2ecYf60/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 2141568874,
          "mode": "list",
          "cachedResultName": "Error",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1EyqhQ9WEeuq0shMHDUZdpWMx32Ns7ioLkSqT2ecYf60/edit#gid=2141568874"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "keyword": "={{ $json.Keyword }}",
            "Error Message ": "={{ $json.error }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "keyword",
              "displayName": "keyword",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Error Message ",
              "displayName": "Error Message ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        672,
        336
      ],
      "id": "fd07b900-be44-4a7f-a512-8c263682c4bc",
      "name": "FLAG ERROR2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ZG1MR4HwHasbUvb4",
          "name": "Cognigenai Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "document_title",
              "name": "document_TITLE",
              "value": "={{ $('Preserve Context').item.json.Keyword }}",
              "type": "string"
            },
            {
              "id": "document_content",
              "name": "document_content",
              "value": "={{ $('Revise Article').isExecuted ? $('Revise Article').first().json.content.parts[0].text : $('Write SEO Article1').first().json.content.parts[0].text }}",
              "type": "string"
            },
            {
              "id": "ebf5d427-74c8-4304-9d60-ec128bf60b84",
              "name": "Keyword",
              "value": "={{ $('Preserve Context').item.json.Keyword }}",
              "type": "string"
            },
            {
              "id": "4a63c586-ea66-4c57-88fe-a27eb0f8e212",
              "name": "overall_score",
              "value": "={{ $('EXTRACT SCORE').item.json.overall_score }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "0948a6ae-40de-407b-8973-bc4ee09be984",
      "name": "FIELDS EXTRACTOR",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [
        2368,
        160
      ]
    },
    {
      "parameters": {
        "jsCode": "// Validate input structure\nif (!$json || typeof $json !== 'object') {\n  return [{\n    json: {\n      error: \"Invalid input: $json is not an object\",\n      overall_score: 5\n    }\n  }];\n}\n\n// Check if content.parts exists\nif (!$json.content || !$json.content.parts || !Array.isArray($json.content.parts) || $json.content.parts.length === 0) {\n  return [{\n    json: {\n      ...$json,\n      error: \"Invalid data structure - expected content.parts array from Gemini\",\n      overall_score: 5\n    }\n  }];\n}\n\n// Check if text exists\nif (!$json.content.parts[0].text) {\n  return [{\n    json: {\n      ...$json,\n      error: \"No text found in content.parts[0]\",\n      overall_score: 5\n    }\n  }];\n}\n\n// Get the text that contains the JSON\nconst raw = $json.content.parts[0].text;\n\n// Extract the JSON part between ```json and ```\nconst match = raw.match(/```json\\s*([\\s\\S]*?)\\s*```/);\n\nif (!match) {\n  // Try without code blocks\n  try {\n    const parsed = JSON.parse(raw);\n    return [{\n      json: {\n        ...$json,\n        overall_score: parsed.overall_score || 5,\n        quality_report: parsed\n      }\n    }];\n  } catch (e) {\n    return [{\n      json: {\n        ...$json,\n        error: \"JSON block not found and raw text is not valid JSON\",\n        overall_score: 5\n      }\n    }];\n  }\n}\n\n// Parse the extracted JSON\ntry {\n  const parsed = JSON.parse(match[1]);\n  \n  // Return the overall_score AND preserve all existing data\n  return [{\n    json: {\n      ...$json,\n      overall_score: parsed.overall_score || 5,\n      quality_report: parsed\n    }\n  }];\n} catch (e) {\n  return [{\n    json: {\n      ...$json,\n      error: `Failed to parse quality score JSON: ${e.message}`,\n      overall_score: 5\n    }\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1408,
        160
      ],
      "id": "e492f95c-ffaa-45f0-94f2-8de53da1854c",
      "name": "EXTRACT SCORE",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1EyqhQ9WEeuq0shMHDUZdpWMx32Ns7ioLkSqT2ecYf60",
          "mode": "list",
          "cachedResultName": "Keyword  Content Generator",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1EyqhQ9WEeuq0shMHDUZdpWMx32Ns7ioLkSqT2ecYf60/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 2141568874,
          "mode": "list",
          "cachedResultName": "Error",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1EyqhQ9WEeuq0shMHDUZdpWMx32Ns7ioLkSqT2ecYf60/edit#gid=2141568874"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "keyword": "={{ $('Preserve Context').item.json.Keyword }}"
          },
          "matchingColumns": [
            "keyword"
          ],
          "schema": [
            {
              "id": "keyword",
              "displayName": "keyword",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Error Message ",
              "displayName": "Error Message ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1616,
        368
      ],
      "id": "9b4cfbf1-412b-4d37-9abe-c13fb66a6527",
      "name": "Update row in sheet1"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        3456,
        160
      ],
      "id": "3f19164d-b589-4998-a317-ecefe1071cd6",
      "name": "Wait",
      "webhookId": "5b75839e-9e63-44f4-b8d7-0cdecb44d095"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -32,
        176
      ],
      "id": "d101feef-e440-4429-b4c3-1ec6badee1a9",
      "name": "Merge"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://google.serper.dev/news",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "q",
              "value": "={{ $json[\"Main Keywords\"] }}, {{ $json[\"Other Keywords\"] }}"
            }
          ]
        },
        "options": {
          "redirect": {
            "redirect": {}
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -272,
        272
      ],
      "id": "a7e4590e-b89f-4c41-bc68-730681be04ac",
      "name": "SERP NEWS",
      "credentials": {
        "httpHeaderAuth": {
          "id": "odw0FaTRUSGiHCOl",
          "name": "Serper dev Header Auth account"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "get",
        "documentURL": "={{ $json.documentId }}"
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        2912,
        160
      ],
      "id": "9d5117ef-6d15-450c-9d26-c873d3805b54",
      "name": "Get a document"
    },
    {
      "parameters": {
        "resource": "document",
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "text": "=Analyseer deze Nederlandse content op plagiaat en retourneer ALLEEN een getal tussen 0-10:\n{{ $json.content }}\n\n\nScore betekenis:\n0-2 = Origineel\n2.1-4 = Lage gelijkenis\n4.1-6 = Gemiddelde gelijkenis  \n6.1-8 = Hoge gelijkenis\n8.1-10 = Waarschijnlijk geplagieerd\n\nRetourneer alleen het getal, bijvoorbeeld: 5 ",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        3088,
        160
      ],
      "id": "0f59547a-6534-4042-961c-1e2962c06bcd",
      "name": "Analyze document"
    },
    {
      "parameters": {
        "formTitle": "Enter Keyword",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Main Keywords",
              "requiredField": true
            },
            {
              "fieldLabel": "Other Keywords"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        -512,
        176
      ],
      "id": "5514b2b9-e2fd-4da5-94a6-60ea37b575e0",
      "name": "On form submission1",
      "webhookId": "cf39bed0-8b44-4c45-a924-c9e72d8c6aab"
    },
    {
      "parameters": {
        "jsCode": "// Get the form submission data\nconst formData = $('On form submission1').first().json;\n\n// Get all merged data (SERP Research + SERP NEWS)\nconst mergedData = $input.all();\n\n// Find SERP Research and SERP News data\nconst serpResearch = mergedData.find(item => item.json.organic || item.json.organic_results);\nconst serpNews = mergedData.find(item => item.json.news);\n\n// Extract and simplify top 5 organic results (title + snippet only)\nlet simplifiedOrganic = [];\nif (serpResearch && (serpResearch.json.organic || serpResearch.json.organic_results)) {\n  const organicResults = serpResearch.json.organic || serpResearch.json.organic_results;\n  simplifiedOrganic = organicResults\n    .slice(0, 5)\n    .map(result => ({\n      title: result.title || '',\n      snippet: result.snippet || ''\n    }));\n}\n\n// Extract and simplify top 5 news results (title + snippet only)\nlet simplifiedNews = [];\nif (serpNews && Array.isArray(serpNews.json.news)) {\n  simplifiedNews = serpNews.json.news\n    .slice(0, 5)\n    .map(newsItem => ({\n      title: newsItem.title || '',\n      snippet: newsItem.snippet || ''\n    }));\n}\n\n// Default reference content\nconst referenceContent = 'No reference content available';\n\n// Combine everything into one output object\nreturn [{\n  json: {\n    Keyword: formData['Main Keywords'],\n    other_keywords: formData['Other Keywords'] || '',\n    target_audience: 'General Dutch audience',\n    word_count: '1500',\n    organic_results: simplifiedOrganic,\n    news: simplifiedNews,\n    reference_content: referenceContent\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        128,
        176
      ],
      "id": "7a3b6764-9c62-4396-9a02-aed76881869c",
      "name": "Preserve Context"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1EyqhQ9WEeuq0shMHDUZdpWMx32Ns7ioLkSqT2ecYf60",
          "mode": "list",
          "cachedResultName": "Keyword  Content Generator",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1EyqhQ9WEeuq0shMHDUZdpWMx32Ns7ioLkSqT2ecYf60/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1EyqhQ9WEeuq0shMHDUZdpWMx32Ns7ioLkSqT2ecYf60/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Keyword": "={{ $('Preserve Context').item.json.Keyword }}",
            "quality_score": "={{ $('EXTRACT SCORE').item.json.overall_score }}",
            "plagiarism_result": "={{ $json.content.parts[0].text }}",
            "article link": "={{ $('DOC CREATOR').item.json.url }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Keyword",
              "displayName": "Keyword",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "quality_score",
              "displayName": "quality_score",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "plagiarism_result",
              "displayName": "plagiarism_result",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "article link",
              "displayName": "article link",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3280,
        160
      ],
      "id": "cff52a9c-8e1d-493b-a525-0688820b22ff",
      "name": "Append row in sheet"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1EyqhQ9WEeuq0shMHDUZdpWMx32Ns7ioLkSqT2ecYf60",
          "mode": "list",
          "cachedResultName": "Keyword  Content Generator",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1EyqhQ9WEeuq0shMHDUZdpWMx32Ns7ioLkSqT2ecYf60/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 2141568874,
          "mode": "list",
          "cachedResultName": "Error",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1EyqhQ9WEeuq0shMHDUZdpWMx32Ns7ioLkSqT2ecYf60/edit#gid=2141568874"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "keyword": "={{ $json[\"Main Keywords\"] }}",
            "Error Message ": "={{ $json.error.message }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "keyword",
              "displayName": "keyword",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Error Message ",
              "displayName": "Error Message ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        0,
        416
      ],
      "id": "1f01a4b8-93bc-49e1-9d23-61606393f490",
      "name": "Append row in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ZG1MR4HwHasbUvb4",
          "name": "Cognigenai Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "formTitle": "Upload Reference Content",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Content FIle",
              "fieldType": "file",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        -448,
        896
      ],
      "id": "ff32c389-c6f1-4728-855f-b43135be7808",
      "name": "On form submission",
      "webhookId": "81085a24-7b25-4da7-ba1a-6cf910fe7f00"
    },
    {
      "parameters": {
        "dataType": "binary",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1.1,
      "position": [
        -64,
        1456
      ],
      "id": "52b837e9-db0f-4bef-93e6-6e4f4c059b2d",
      "name": "Default Data Loader"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
      "typeVersion": 1,
      "position": [
        -352,
        1456
      ],
      "id": "1b7d3d88-6f3a-4d10-ad50-7a656ef76ad8",
      "name": "Embeddings Google Gemini"
    },
    {
      "parameters": {
        "mode": "insert",
        "memoryKey": {
          "__rl": true,
          "value": "vector_store_key",
          "mode": "list",
          "cachedResultName": "vector_store_key"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
      "typeVersion": 1.2,
      "position": [
        -272,
        896
      ],
      "id": "df03cc62-427b-42dd-9aea-1c4b4cbe0213",
      "name": "Insert Articles"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "Geef voorbeelden van schrijfstijl, toon en structuur.",
        "memoryKey": {
          "__rl": true,
          "mode": "list",
          "value": "vector_store_key"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
      "typeVersion": 1.3,
      "position": [
        80,
        1088
      ],
      "id": "ba3fce93-111e-4d62-9849-b5f17fc549b7",
      "name": "Article Source"
    }
  ],
  "connections": {
    "SERP Research": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "FLAG ERROR1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze Research Data": {
      "main": [
        [
          {
            "node": "Write SEO Article1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "FLAG ERROR2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Write SEO Article1": {
      "main": [
        [
          {
            "node": "Content Quality Check",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Content Quality Check": {
      "main": [
        [
          {
            "node": "EXTRACT SCORE",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Revise Article": {
      "main": [
        [
          {
            "node": "FIELDS EXTRACTOR",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TITLE EXTRACTOR": {
      "main": [
        [
          {
            "node": "DOC CREATOR",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DOC CREATOR": {
      "main": [
        [
          {
            "node": "Get a document",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Quality CHECK": {
      "main": [
        [
          {
            "node": "FIELDS EXTRACTOR",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Revise Article",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "FIELDS EXTRACTOR": {
      "main": [
        [
          {
            "node": "TITLE EXTRACTOR",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "EXTRACT SCORE": {
      "main": [
        [
          {
            "node": "Quality CHECK",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Update row in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Preserve Context",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "SERP NEWS": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ],
        [
          {
            "node": "Append row in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get a document": {
      "main": [
        [
          {
            "node": "Analyze document",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze document": {
      "main": [
        [
          {
            "node": "Append row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "On form submission1": {
      "main": [
        [
          {
            "node": "SERP Research",
            "type": "main",
            "index": 0
          },
          {
            "node": "SERP NEWS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Preserve Context": {
      "main": [
        [
          {
            "node": "Analyze Research Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "On form submission": {
      "main": [
        [
          {
            "node": "Insert Articles",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader": {
      "ai_document": [
        [
          {
            "node": "Insert Articles",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings Google Gemini": {
      "ai_embedding": [
        [
          {
            "node": "Insert Articles",
            "type": "ai_embedding",
            "index": 0
          },
          {
            "node": "Article Source",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Article Source": {
      "ai_tool": [
        [
          {
            "node": "Write SEO Article1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": null,
  "pinData": {},
  "versionId": "04eebbde-44af-4e8d-83f6-22bba1a66aa8",
  "triggerCount": 0,
  "shared": [
    {
      "createdAt": "2025-10-03T13:19:15.840Z",
      "updatedAt": "2025-10-03T13:19:15.840Z",
      "role": "workflow:owner",
      "workflowId": "yLZqcYCIteTJe3K0",
      "projectId": "nnULjHyqOVknXpmc"
    }
  ],
  "tags": []
}